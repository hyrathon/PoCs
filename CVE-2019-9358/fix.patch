diff --git a/src/nfc/tags/ce_t3t.cc b/src/nfc/tags/ce_t3t.cc
index 461b9ed..1c4092f 100644
--- a/src/nfc/tags/ce_t3t.cc
+++ b/src/nfc/tags/ce_t3t.cc
@@ -667,6 +667,11 @@ void ce_t3t_data_cback(tNFC_DATA_CEVT* p_data) {
         STREAM_TO_ARRAY(cmd_nfcid2, p, NCI_RF_F_UID_LEN);
         STREAM_TO_UINT8(p_cb->cur_cmd.num_services, p);
 
+        if(p_cb->cur_cmd.num_services > T3T_MSG_SERVICE_LIST_MAX){
+          LOG(ERROR) << StringPrintf("num_services is too big");
+          p_cb->cur_cmd.num_services = T3T_MSG_SERVICE_LIST_MAX;
+        }
+
         /* Calculate offset of block-list-start */
         block_list_start_offset =
             T3T_MSG_CMD_COMMON_HDR_LEN + 2 * p_cb->cur_cmd.num_services + 1;
